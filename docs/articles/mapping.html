<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Customizing maps in colorist • colorist</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Customizing maps in colorist">
<meta property="og:description" content="colorist">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">colorist</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/introduction.html">Introduction</a>
</li>
<li>
  <a href="../articles/tuning.html">Tuning Visualizations</a>
</li>
<li>
  <a href="../articles/mapping.html">Customizing Maps</a>
</li>
<li>
  <a href="../reference/index.html">Function Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mstrimas/colorist/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="mapping_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Customizing maps in colorist</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mstrimas/colorist/blob/master/vignettes/mapping.Rmd"><code>vignettes/mapping.Rmd</code></a></small>
      <div class="hidden name"><code>mapping.Rmd</code></div>

    </div>

    
    
<p>In the <a href="https://strimas.com/colorist/articles/introduction.html">Introduction to colorist</a> and <a href="https://strimas.com/colorist/articles/tuning.html">Tuning visualizations in colorist</a> vignettes, we provided an overview of <code>colorist</code> functionality and explored how users might adjust visualizations to address specific narrative goals. Here, we focus on several issues that users may confront when making finished visualizations:</p>
<ol style="list-style-type: decimal">
<li>Adding context to <code>colorist</code> maps using supplementary spatial data</li>
<li>Modifying <code>colorist</code> legends</li>
<li>Displaying <code>colorist</code> maps in other R spatial packages and external GIS software</li>
</ol>
<p>We start by loading the necessary libraries.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mstrimas/colorist">colorist</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster">raster</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ropenscilabs/rnaturalearth">rnaturalearth</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/walkerke/tigris">tigris</a></span><span class="op">)</span></code></pre></div>
<div id="adding-context" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-context" class="anchor"></a>1. Adding context</h2>
<p>It’s easy to imagine users wanting to add context to visualizations generated by <code>colorist</code>, to help explain the causes of particular spatiotemporal distributions. Here, we focus on showing how Natural Earth and US Census TIGER/Line data can be accessed from within R and incorporated into <code>colorist</code> maps.</p>
<div id="rnaturalearth-package" class="section level3">
<h3 class="hasAnchor">
<a href="#rnaturalearth-package" class="anchor"></a><code>rnaturalearth</code> package</h3>
<p>Natural Earth is a public domain data set that contains vector and raster data developed for display at several different map scales. Files describing physical and cultural geographies can be accessed through R using functions in the <code>rnaturalearth</code> package. Here, we download Natural Earth vector data and add it to a map describing the spatiotemporal distribution of Field Sparrow, a small bird that occurs in the eastern United States. We begin by calculating distribution metrics for Field Sparrow with <code><a href="../reference/metrics_distill.html">metrics_distill()</a></code>, choosing a palette with <code><a href="../reference/palette_timecycle.html">palette_timecycle()</a></code>, and creating a map with <code><a href="../reference/map_single.html">map_single()</a></code>. Note that we choose to save the <code>ggplot2</code> map as an object.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># calculate metrics, choose a palette, make a map</span>
<span class="va">m_fiespa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/metrics_distill.html">metrics_distill</a></span><span class="op">(</span><span class="va">fiespa_occ</span><span class="op">)</span>
<span class="va">p_fiespa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/palette_timecycle.html">palette_timecycle</a></span><span class="op">(</span><span class="va">fiespa_occ</span><span class="op">)</span>
<span class="va">map_fiespa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map_single.html">map_single</a></span><span class="op">(</span><span class="va">m_fiespa</span>, <span class="va">p_fiespa</span><span class="op">)</span></code></pre></div>
<p>Then, we use the <code><a href="https://rdrr.io/pkg/rnaturalearth/man/ne_download.html">ne_download()</a></code> function from <code>rnaturalearth</code> to download country, river, and lake spatial data as <code>sf</code> (simple features) objects, which are easy to incorporate into our existing map. In the process, we project and crop each data set to the same projection and extent as our Field Sparrow data. To avoid annoying topology and projection issues, we create our own ocean polygon by calculating the difference between a polygon describing the extent of the Field Sparrow map and the polygon describing countries.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># download, transform, and crop spatial data</span>
<span class="va">countries</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rnaturalearth/man/ne_download.html">ne_download</a></span><span class="op">(</span>category <span class="op">=</span> <span class="st">"cultural"</span>, type <span class="op">=</span> <span class="st">"countries"</span>, 
                         returnclass <span class="op">=</span> <span class="st">"sf"</span>, scale <span class="op">=</span> <span class="fl">110</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">fiespa_occ</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crop.html">st_crop</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html">st_bbox</a></span><span class="op">(</span><span class="va">fiespa_occ</span><span class="op">)</span><span class="op">)</span>

<span class="va">rivers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rnaturalearth/man/ne_download.html">ne_download</a></span><span class="op">(</span>category <span class="op">=</span> <span class="st">"physical"</span>, type <span class="op">=</span> <span class="st">"rivers_lake_centerlines"</span>, 
                      returnclass <span class="op">=</span> <span class="st">"sf"</span>, scale <span class="op">=</span> <span class="fl">110</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">fiespa_occ</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crop.html">st_crop</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html">st_bbox</a></span><span class="op">(</span><span class="va">fiespa_occ</span><span class="op">)</span><span class="op">)</span>

<span class="va">lakes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rnaturalearth/man/ne_download.html">ne_download</a></span><span class="op">(</span>category <span class="op">=</span> <span class="st">"physical"</span>, type <span class="op">=</span> <span class="st">"lakes"</span>, returnclass <span class="op">=</span> <span class="st">"sf"</span>, 
                     scale <span class="op">=</span> <span class="fl">110</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">fiespa_occ</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crop.html">st_crop</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html">st_bbox</a></span><span class="op">(</span><span class="va">fiespa_occ</span><span class="op">)</span><span class="op">)</span>

<span class="co"># create polygon describing ocean</span>
<span class="va">ocean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sfc.html">st_as_sfc</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html">st_bbox</a></span><span class="op">(</span><span class="va">fiespa_occ</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_binary_ops.html">st_difference</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_combine.html">st_union</a></span><span class="op">(</span><span class="va">countries</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>We add the supplementary spatial data to the map by appending <code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf()</a></code> elements to the underlying map and symbolizing each element according to our specifications. We also add a bounding rectangle to our map.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># add supplementary spatial data to map</span>
<span class="va">map_fiespa_ne</span> <span class="op">&lt;-</span> <span class="va">map_fiespa</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ocean</span>, fill <span class="op">=</span> <span class="st">"gray95"</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">rivers</span>, size <span class="op">=</span> <span class="fl">0.25</span>, color <span class="op">=</span> <span class="st">"gray35"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">lakes</span>, fill <span class="op">=</span> <span class="st">"gray95"</span>, size <span class="op">=</span> <span class="fl">0.25</span>, color <span class="op">=</span> <span class="st">"gray35"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sfc.html">st_as_sfc</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html">st_bbox</a></span><span class="op">(</span><span class="va">fiespa_occ</span><span class="op">)</span><span class="op">)</span>, fill <span class="op">=</span> <span class="cn">NA</span>, color <span class="op">=</span> <span class="st">"black"</span>, 
          size <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> 

<span class="co"># show the map</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">map_fiespa_ne</span><span class="op">)</span></code></pre></div>
<p><img src="mapping_files/figure-html/fiespa-ne-1.png" width="\textwidth" style="display: block; margin: auto;"></p>
<p>Now, we have a clearer perspective on the spatiotemporal distribution of Field Sparrow in relation to a variety of easily recognizable geographic features in North America.</p>
</div>
<div id="tigris-package" class="section level3">
<h3 class="hasAnchor">
<a href="#tigris-package" class="anchor"></a><code>tigris</code> package</h3>
<p>Next, we integrate spatial data from the <code>tigris</code> package into a map describing Fisher use of a territory in upstate New York over the course of nine nights. The <code>tigris</code> package enables download of TIGER/Line data generated by the United States Census Bureau. Files detail a wide array of geographic features, area delineations, and place names throughout the United States.</p>
<p>In contrast to the previous example, we start by using the <code><a href="../reference/metrics_pull.html">metrics_pull()</a></code>, <code><a href="../reference/palette_timeline.html">palette_timeline()</a></code>, and <code><a href="../reference/map_multiples.html">map_multiples()</a></code> functions to visualize individual raster layers from the Fisher data set. We adjust <code>lambda_i</code> within <code><a href="../reference/map_multiples.html">map_multiples()</a></code> to emphasize areas that were used only briefly by the Fisher.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># calculate metrics, choose a palette, make a series of maps</span>
<span class="va">m_fisher</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/metrics_pull.html">metrics_pull</a></span><span class="op">(</span><span class="va">fisher_ud</span><span class="op">)</span>
<span class="va">p_fisher</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/palette_timeline.html">palette_timeline</a></span><span class="op">(</span><span class="fl">9</span>, start_hue <span class="op">=</span> <span class="op">-</span><span class="fl">40</span><span class="op">)</span>
<span class="va">map_fisher</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map_multiples.html">map_multiples</a></span><span class="op">(</span><span class="va">m_fisher</span>, <span class="va">p_fisher</span>, lambda_i <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>, 
                            labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"April"</span>, <span class="fl">7</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>To download spatial data using <code>tigris</code> we need to know that the Fisher study area is located in Rensselaer County, New York. Then, we can access linear water features, areal water features, and roads for the county using <code>tigris</code> functions, projecting and cropping our supplementary spatial data along the way. <code>tigris</code> functions provide data formatted as <code>sf</code> objects.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># download, transform, and crop spatial data</span>
<span class="va">streams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tigris/man/linear_water.html">linear_water</a></span><span class="op">(</span><span class="st">"NY"</span>, <span class="st">"Rensselaer"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">fisher_ud</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crop.html">st_crop</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html">st_bbox</a></span><span class="op">(</span><span class="va">fisher_ud</span><span class="op">)</span><span class="op">)</span>

<span class="va">ponds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tigris/man/area_water.html">area_water</a></span><span class="op">(</span><span class="st">"NY"</span>, <span class="st">"Rensselaer"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">fisher_ud</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crop.html">st_crop</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html">st_bbox</a></span><span class="op">(</span><span class="va">fisher_ud</span><span class="op">)</span><span class="op">)</span>

<span class="va">roads</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tigris/man/roads.html">roads</a></span><span class="op">(</span><span class="st">"NY"</span>, <span class="st">"Rensselaer"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">fisher_ud</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crop.html">st_crop</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html">st_bbox</a></span><span class="op">(</span><span class="va">fisher_ud</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>As in the previous example, we add our spatial data to the underlying <code>colorist</code> map using <code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf()</a></code> elements and we add an unobtrusive bounding box to more clearly define the facets of our plot.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># add supplementary spatial data to the series of maps</span>
<span class="va">map_fisher</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">streams</span>, linetype <span class="op">=</span> <span class="fl">6</span>, color <span class="op">=</span> <span class="st">"lightblue4"</span>, size <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ponds</span>, linetype <span class="op">=</span> <span class="fl">6</span>, color <span class="op">=</span> <span class="st">"lightblue4"</span>, fill <span class="op">=</span> <span class="st">"lightblue"</span>, 
          size <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">roads</span>, size <span class="op">=</span> <span class="fl">0.25</span>, color <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org//reference/alpha.html">alpha</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sfc.html">st_as_sfc</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html">st_bbox</a></span><span class="op">(</span><span class="va">fisher_ud</span><span class="op">)</span><span class="op">)</span>, fill <span class="op">=</span> <span class="cn">NA</span>, color <span class="op">=</span> <span class="st">"gray"</span>, 
          size <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></code></pre></div>
<p><img src="mapping_files/figure-html/fisher-multiples-tigris-1.png" width="\textwidth" style="display: block; margin: auto;"></p>
<p>Now we can clearly see how the Fisher moved throughout its territory across nights and in relation to the locations of roads, streams, and ponds.</p>
</div>
<div id="general-comments" class="section level3">
<h3 class="hasAnchor">
<a href="#general-comments" class="anchor"></a>General comments</h3>
<p>We recommend trying to keep a “light touch” with edits to <code>colorist</code> maps to ensure that information about spatiotemporal distributions remains the focus. In addition, it’s important to keep in mind that <code>colorist</code> visualizations rely on differences in cell opacity to communicate information about differences in intensity; changing the plot background color from white will make the map difficult to interpret.</p>
</div>
</div>
<div id="modifying-legends" class="section level2">
<h2 class="hasAnchor">
<a href="#modifying-legends" class="anchor"></a>2. Modifying legends</h2>
<p>The legend functions in <code>colorist</code> generate <code>ggplot2</code> plot objects, some of which are fairly complicated. Here, we focus on modifying legends to aid interpretation and combining legends and maps within a <code>ggplot2</code> framework.</p>
<div id="legend_timecyle" class="section level3">
<h3 class="hasAnchor">
<a href="#legend_timecyle" class="anchor"></a><code>legend_timecyle()</code>
</h3>
<p>When we make a legend for the Field Sparrow annual cycle map described above, the default settings do not communicate the meanings of intensity, specificity, or layer very clearly.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create a legend using default settings</span>
<span class="fu"><a href="../reference/legend_timecycle.html">legend_timecycle</a></span><span class="op">(</span><span class="va">p_fiespa</span><span class="op">)</span></code></pre></div>
<p><img src="mapping_files/figure-html/fiespa-legend-1.png" width="\textwidth" style="display: block; margin: auto;"></p>
<p>Remember, we have distilled distribution metrics from a stack of monthly occurrence probabilities, so intensity values represent maximum occurrence throughout the year, specificity values indicate the degree of seasonality in occurrences, and layer values reveal the month of maximum occurrence. We can edit the legend to clarify these interpretations by making several changes in the <code><a href="../reference/legend_timecycle.html">legend_timecycle()</a></code> function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># change labels on legend</span>
<span class="va">l_fiespa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/legend_timecycle.html">legend_timecycle</a></span><span class="op">(</span><span class="va">p_fiespa</span>, 
                             origin_label <span class="op">=</span> <span class="st">"Jan 1"</span>,
                             <span class="co"># specificity labels</span>
                             label_s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Low\nseasonality"</span>, 
                                         <span class="st">"Moderate\nseasonality"</span>, 
                                         <span class="st">"High\nseasonality"</span><span class="op">)</span>, 
                             <span class="co"># intensity label</span>
                             label_i <span class="op">=</span> <span class="st">"Peak occurrence"</span>, 
                             <span class="co"># layers label</span>
                             label_l <span class="op">=</span> <span class="st">"Month of peak occurrence"</span><span class="op">)</span>

<span class="co"># show legend</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">l_fiespa</span><span class="op">)</span></code></pre></div>
<p><img src="mapping_files/figure-html/fiespa-legend-custom-1.png" width="\textwidth" style="display: block; margin: auto;"></p>
<p>Better.</p>
<p>Now, we need to decide where to position the legend in relation to the map describing the spatiotemporal distribution of Field Sparrow. After playing with several ideas, we place the legend beneath the main map. This requires expanding the spatial extent of the plot using the <code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">coord_sf()</a></code> function and then inserting the legend into the “empty landscape” using <code><a href="https://ggplot2.tidyverse.org/reference/annotation_custom.html">annotation_custom()</a></code>. Note that the values in <code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">coord_sf()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/annotation_custom.html">annotation_custom()</a></code> are in projected map coordinates.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># position legend below map</span>
<span class="va">map_fiespa_ne</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">coord_sf</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3153281</span>, <span class="fl">1405830</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotation_custom.html">annotation_custom</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplotGrob.html">ggplotGrob</a></span><span class="op">(</span><span class="va">l_fiespa</span><span class="op">)</span>, 
                    xmin <span class="op">=</span> <span class="op">-</span><span class="fl">1482551</span>, xmax <span class="op">=</span> <span class="fl">1850606</span>, 
                    ymin <span class="op">=</span> <span class="op">-</span><span class="fl">3153281</span>, ymax <span class="op">=</span> <span class="op">-</span><span class="fl">1453281</span><span class="op">)</span></code></pre></div>
<p><img src="mapping_files/figure-html/fiespa-map-1.png" width="\textwidth" style="display: block; margin: auto;"></p>
</div>
<div id="legend_timeline" class="section level3">
<h3 class="hasAnchor">
<a href="#legend_timeline" class="anchor"></a><code>legend_timeline()</code>
</h3>
<p>The strategy for editing details of <code><a href="../reference/legend_timeline.html">legend_timeline()</a></code> plots is similar to that for <code><a href="../reference/legend_timecycle.html">legend_timecycle()</a></code> plots, despite differences in their layouts. Before changing the legend, however, we should use <code><a href="../reference/metrics_distill.html">metrics_distill()</a></code> and <code><a href="../reference/map_single.html">map_single()</a></code> to describe Fisher use of its territory over nine nights in a single map. Because we’re making one larger map, we’re also going to add another layer of spatial data describing building footprints in the area. These features come from the <a href="https://wiki.openstreetmap.org/wiki/Microsoft_Building_Footprint_Data">OpenStreeMap Microsoft Building Footprint</a> dataset, a cropped and projected copy of which is <a href="https://github.com/mstrimas/colorist/blob/master/data-raw/buildings.rds">available on the GitHub repository</a> for this package.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># calculate distribution metrics  </span>
<span class="va">m_fisher_distill</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/metrics_distill.html">metrics_distill</a></span><span class="op">(</span><span class="va">fisher_ud</span><span class="op">)</span>

<span class="co"># download building footprints</span>
<span class="va">f_buildings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"buildings.rds"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"https://github.com/mstrimas/colorist/raw/master/"</span>,
                     <span class="st">"data-raw/buildings.rds"</span><span class="op">)</span>,
              <span class="va">f_buildings</span><span class="op">)</span>
<span class="va">buildings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="va">f_buildings</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/unlink.html">unlink</a></span><span class="op">(</span><span class="va">f_buildings</span><span class="op">)</span>

<span class="co"># make a map</span>
<span class="va">map_fisher_distill</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map_single.html">map_single</a></span><span class="op">(</span><span class="va">m_fisher_distill</span>, <span class="va">p_fisher</span>, 
                                 lambda_i <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>, lambda_s <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">streams</span>, linetype <span class="op">=</span> <span class="fl">6</span>, color <span class="op">=</span> <span class="st">"lightblue4"</span>, size <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ponds</span>, linetype <span class="op">=</span> <span class="fl">6</span>, color <span class="op">=</span> <span class="st">"lightblue4"</span>, fill <span class="op">=</span> <span class="st">"lightblue"</span>, 
          size <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">roads</span>, size <span class="op">=</span> <span class="fl">0.25</span>, color <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org//reference/alpha.html">alpha</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">buildings</span>, size <span class="op">=</span> <span class="fl">0.25</span>, color <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org//reference/alpha.html">alpha</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sfc.html">st_as_sfc</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html">st_bbox</a></span><span class="op">(</span><span class="va">fisher_ud</span><span class="op">)</span><span class="op">)</span>, fill <span class="op">=</span> <span class="cn">NA</span>, color <span class="op">=</span> <span class="st">"black"</span>, 
          size <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span>

<span class="co"># show the map</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">map_fisher_distill</span><span class="op">)</span></code></pre></div>
<p><img src="mapping_files/figure-html/fisher-single-1.png" width="\textwidth" style="display: block; margin: auto;"></p>
<p>Setting <code>lambda_i = -5</code> makes rarely used parts of the landscape more conspicuous and setting <code>lambda_s = 10</code> emphasizes differences in how consistently areas were used across nights. Spatial data for Rensselaer County are added to the map using <code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf()</a></code> elements, just as in the previous section.</p>
<p>Now, let us generate a default legend for our Fisher data using <code><a href="../reference/legend_timeline.html">legend_timeline()</a></code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create a legend using default settings</span>
<span class="fu"><a href="../reference/legend_timeline.html">legend_timeline</a></span><span class="op">(</span><span class="va">p_fisher</span><span class="op">)</span></code></pre></div>
<p><img src="mapping_files/figure-html/fisher-legend-1.png" width="\textwidth" style="display: block; margin: auto;"></p>
<p>To make the legend more helpful as a guide to interpreting the spatiotemporal distribution of the Fisher, we need to edit intensity, specificity, and layer labels. So, we modify <code>label_s</code>, <code>label_i</code>, and <code>label_l</code> in <code><a href="../reference/legend_timeline.html">legend_timeline()</a></code> to reflect their meanings with respect to the Fisher data. We also prescribe how the ends of the timeline are labeled using the<code>time_labels</code> argument.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># change labels of legend</span>
<span class="va">l_fisher</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/legend_timeline.html">legend_timeline</a></span><span class="op">(</span><span class="va">p_fisher</span>, 
                            time_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Apr 7"</span>, <span class="st">"Apr 15"</span><span class="op">)</span>,
                            <span class="co"># intensity label</span>
                            label_i <span class="op">=</span> <span class="st">"Peak use"</span>, 
                            <span class="co"># layer label</span>
                            label_l <span class="op">=</span> <span class="st">"Night of peak use"</span>,
                            <span class="co"># specificity labels</span>
                            label_s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Consistent use"</span>, <span class="st">"Occasional use"</span>, <span class="st">"Ephemeral use"</span><span class="op">)</span><span class="op">)</span> 

<span class="co"># show legend</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">l_fisher</span><span class="op">)</span></code></pre></div>
<p><img src="mapping_files/figure-html/fisher-legend-custom-1.png" width="\textwidth" style="display: block; margin: auto;"></p>
<p>To place our legend next to the map, we expand the extent of our plot by modifying <code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">coord_sf()</a></code> and we specify its position using the <code><a href="https://ggplot2.tidyverse.org/reference/annotation_custom.html">annotation_custom()</a></code> function.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># position legend to the left of the map</span>
<span class="va">map_fisher_distill</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4300</span>, <span class="fl">2150</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotation_custom.html">annotation_custom</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplotGrob.html">ggplotGrob</a></span><span class="op">(</span><span class="va">l_fisher</span><span class="op">)</span>, 
                    xmin <span class="op">=</span> <span class="op">-</span><span class="fl">4400</span>, xmax <span class="op">=</span> <span class="op">-</span><span class="fl">2500</span>, 
                    ymin <span class="op">=</span> <span class="fl">5100266</span>, ymax <span class="op">=</span> <span class="fl">5104666</span><span class="op">)</span> </code></pre></div>
<p><img src="mapping_files/figure-html/map-fisher-1.png" width="\textwidth" style="display: block; margin: auto;"></p>
</div>
<div id="legend_set" class="section level3">
<h3 class="hasAnchor">
<a href="#legend_set" class="anchor"></a><code>legend_set()</code>
</h3>
<p>Here, we return to data describing the utilization distributions of two African Elephants in Etosha National Park in 2011. The two layers of the RasterStack form an unordered set of distributions, one for each individual. To visualize how the elephants partitioned space, we begin by calculating distribution metrics using <code><a href="../reference/metrics_distill.html">metrics_distill()</a></code>, creating a palette with <code><a href="../reference/palette_set.html">palette_set()</a></code>, and generating a map with <code><a href="../reference/map_single.html">map_single()</a></code>. We add visual emphasis to rarely used areas via the <code>lambda_i</code> argument.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># calculate metrics, choose a palette, make a series of maps</span>
<span class="va">m_elephants</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/metrics_distill.html">metrics_distill</a></span><span class="op">(</span><span class="va">elephant_ud</span><span class="op">)</span>
<span class="va">p_elephants</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/palette_set.html">palette_set</a></span><span class="op">(</span><span class="va">elephant_ud</span><span class="op">)</span>
<span class="va">map_elephants</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map_single.html">map_single</a></span><span class="op">(</span><span class="va">m_elephants</span>, <span class="va">p_elephants</span>, lambda_i <span class="op">=</span> <span class="op">-</span><span class="fl">5</span><span class="op">)</span></code></pre></div>
<p>This should all seem familiar.</p>
<p>Next, we build a legend using our palette and the default settings in <code><a href="../reference/legend_set.html">legend_set()</a></code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create a legend using default settings</span>
<span class="fu"><a href="../reference/legend_set.html">legend_set</a></span><span class="op">(</span><span class="va">p_elephants</span><span class="op">)</span></code></pre></div>
<p><img src="mapping_files/figure-html/elephants-legend-1.png" width="\textwidth" style="display: block; margin: auto;"></p>
<p>The legend is meant to tell us how the two individuals partitioned space in Etosha National Park over the course of a year, allowing viewers to understand locations that were used predominantly by one individual, or the other, and locations that were used equally by both individuals.</p>
<p>To help communicate this information more clearly, we should make some adjustments to the legend. We can label the two facets with individual identifiers using the <code>group_labels</code> argument in <code><a href="../reference/legend_set.html">legend_set()</a></code> and we can modify<code>label_i</code>,<code>label_s</code>, and <code>axis_s</code> values to orient viewers.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># change labels of legend</span>
<span class="va">l_elephants</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/legend_set.html">legend_set</a></span><span class="op">(</span><span class="va">p_elephants</span>, 
                          group_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/names.html">names</a></span><span class="op">(</span><span class="va">elephant_ud</span><span class="op">)</span>,
                          <span class="co"># intensity label</span>
                          label_i <span class="op">=</span> <span class="st">"Intensity of use"</span>,
                          <span class="co"># specificity label</span>
                          label_s <span class="op">=</span> <span class="st">"Share of use"</span>,
                          <span class="co"># specificty axis</span>
                          axis_s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"equal"</span>, <span class="st">"sole"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># show legend</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">l_elephants</span><span class="op">)</span></code></pre></div>
<p><img src="mapping_files/figure-html/elephant-legend-custom-1.png" width="\textwidth" style="display: block; margin: auto;"></p>
<p>Now, we have a legend that further reveals the narrative of space use by LA11 and LA14 in 2011 and we can position it within the map using <code><a href="https://ggplot2.tidyverse.org/reference/annotation_custom.html">annotation_custom()</a></code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># position legend within map</span>
<span class="va">map_elephants</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotation_custom.html">annotation_custom</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplotGrob.html">ggplotGrob</a></span><span class="op">(</span><span class="va">l_elephants</span><span class="op">)</span>, 
                    xmin <span class="op">=</span> <span class="op">-</span><span class="fl">3000</span>, xmax <span class="op">=</span> <span class="fl">37000</span>, 
                    ymin <span class="op">=</span> <span class="op">-</span><span class="fl">2347500</span>, ymax <span class="op">=</span> <span class="op">-</span><span class="fl">2305000</span><span class="op">)</span></code></pre></div>
<p><img src="mapping_files/figure-html/elephants-map-1.png" width="\textwidth" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="displaying-colorist-maps-in-other-software" class="section level2">
<h2 class="hasAnchor">
<a href="#displaying-colorist-maps-in-other-software" class="anchor"></a>3. Displaying <code>colorist</code> maps in other software</h2>
<p><code>colorist</code> uses <code>ggplot2</code> to construct visualizations because it is an incredibly flexible visualization tool that enables maps and legends to be amended and adjusted in many different ways. However, some users may want to employ other tools for visualizing <code>colorist</code> outputs, because of their greater familiarity with those tools or because of specific features that are not available in <code>colorist</code> or <code>ggplot2</code>.</p>
<p>Many of the R packages that enable plotting of spatial data (and most external GIS software) rely on RGBa descriptions of color and opacity instead of the hexadecimal-alpha descriptions used in <code>colorist</code> functions. To accommodate display of <code>colorist</code> maps in these other tools, the <code><a href="../reference/map_single.html">map_single()</a></code> function can be used to return a <code>RasterStack</code> object containing layers of red, green, blue, and alpha information. Users can then visualize those data in a variety of other tools.</p>
<div id="raster-package" class="section level3">
<h3 class="hasAnchor">
<a href="#raster-package" class="anchor"></a><code>raster</code> package</h3>
<p>The <code>raster</code> package is a workhorse for handling and analyzing gridded spatial data in R. Here, we return to our Field Sparrow data, but instead of accepting the default <code>colorist</code> map output, we specify <code>return_type = "stack"</code> in the <code><a href="../reference/map_single.html">map_single()</a></code> function. This change directs <code><a href="../reference/map_single.html">map_single()</a></code> to return an RGBa stack instead of a <code>ggplot2</code> plot object.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ask for map as a raster stack</span>
<span class="va">s_fiesp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map_single.html">map_single</a></span><span class="op">(</span><span class="va">m_fiespa</span>, <span class="va">p_fiespa</span>, return_type <span class="op">=</span> <span class="st">"stack"</span><span class="op">)</span>

<span class="co"># show stack information</span>
<span class="va">s_fiesp</span>
<span class="co">#&gt; class      : RasterStack </span>
<span class="co">#&gt; dimensions : 193, 225, 43425, 5  (nrow, ncol, ncell, nlayers)</span>
<span class="co">#&gt; resolution : 14814.03, 14814.04  (x, y)</span>
<span class="co">#&gt; extent     : -1482551, 1850606, -1453281, 1405830  (xmin, xmax, ymin, ymax)</span>
<span class="co">#&gt; crs        : +proj=laea +lat_0=38.7476367322638 +lon_0=-90.2379515912106 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0 </span>
<span class="co">#&gt; names      :   R,   G,   B, alpha, n_layers </span>
<span class="co">#&gt; min values :   0,   0,   0,     0,        0 </span>
<span class="co">#&gt; max values : 200, 140, 216,   255,       12</span></code></pre></div>
<p>With a <code>RasterStack</code> describing our map in RGBa values, we can now opt to visualize the data using plot functions available in the <code>raster</code> package. The standard <code><a href="https://rdrr.io/pkg/raster/man/plot.html">raster::plot()</a></code> function illustrates each layer of the RasterStack in a standard color palette. In addition to the R, G, B, and alpha layers, note the last layer (i.e., <code>n_layers</code>) which describes, in every cell, the number of layers in the original <code>fiespa_occ</code> data set containing non-NA occurrence values.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># plot layers using raster plot function</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">s_fiesp</span><span class="op">)</span></code></pre></div>
<p><img src="mapping_files/figure-html/fiespa-rgban-raster-1.png" width="\textwidth" style="display: block; margin: auto;"></p>
<p>To reconstruct our <code>colorist</code> map with the appropriate color scheme, we visualize the stack using <code><a href="https://rdrr.io/pkg/raster/man/plotRGB.html">raster::plotRGB()</a></code>, which requires specification of R, G, and B layers. It also requires specification of alpha values as a vector. If all has gone well, the resulting plot should look the same as the <code>ggplot2</code> plot generated within <code>colorist</code>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># plot r, g, b, and alpha layers to reconstruct colorist map</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plotRGB.html">plotRGB</a></span><span class="op">(</span><span class="va">s_fiesp</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.matrix.html">as.vector</a></span><span class="op">(</span><span class="va">s_fiesp</span><span class="op">[[</span><span class="st">"alpha"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="mapping_files/figure-html/fiespa-rgban-map-1.png" width="\textwidth" style="display: block; margin: auto;"></p>
<p>You can then add supplementary spatial data to your raster using other plot functions within <code>raster</code> and related packages.</p>
</div>
<div id="qgis" class="section level3">
<h3 class="hasAnchor">
<a href="#qgis" class="anchor"></a>QGIS</h3>
<p>There are situations in which you may want to use external GIS software instead of R to create a refined cartographic visualization of <code>colorist</code> output. Here, we show how to recreate <code>colorist</code> maps in QGIS, a powerful and free GIS.</p>
<p>Here, we reuse metrics and palette information that we have already generated for two African Elephants to create a map. Instead of accepting the default settings in the <code><a href="../reference/map_single.html">map_single()</a></code> function, however, we specify <code>return_type = "stack"</code> and save the output as a <code>RasterStack</code>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ask for map as a RasterStack object</span>
<span class="va">s_elephants</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map_single.html">map_single</a></span><span class="op">(</span><span class="va">m_elephants</span>, <span class="va">p_elephants</span>, lambda_i <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>, 
                          return_type <span class="op">=</span> <span class="st">"stack"</span><span class="op">)</span>

<span class="co"># save RasterStack to R working directory</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/writeRaster.html">writeRaster</a></span><span class="op">(</span><span class="va">s_elephants</span>, <span class="st">"elephants_rgba.grd"</span><span class="op">)</span></code></pre></div>
<p>Then, we drag the resulting file into an empty QGIS workspace to begin the visualization process.</p>
<p><img src="qgis-screenshot-default.png"></p>
<p>The default symbology assigned to the multiband raster by QGIS makes it appear as if our map were created using a box of pastels. To correct the appearance of the map colors, double-click on the elephant_rgba layer to open Layer Properties and ensure that data are being rendered in multiband color, RGB bands are in the correct order, and min and max values for all three bands are 0 and 255, respectively. In addition, be sure that band 4 (i.e., alpha) is specified as the transparency band in the Transparency tab of Layer Properties.</p>
<p><img src="qgis-screenshot-symbology.png"></p>
<p>After clicking Apply, the thumbnail at the base of the layer properties interface should correctly reproduce the map we were able to generate in R. Click OK. Avoid making further changes to the symbology of elephant_rgba, otherwise map colors will not match those generated in the <code>colorist</code> palette and the map will become difficult to interpret. Now, users can add and symbolize spatial data using sophisticated cartographic tools available within QGIS.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="http://www.justinschuetz.com/">Justin Schuetz</a>, <a href="http://strimas.com">Matthew Strimas-Mackey</a>, <a href="http://twitter.com/tom_auer">Tom Auer</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
